<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>折扣计算器</title>
    <style>
        .product-item {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>折扣计算器</h1>
    <div id="products"></div>
    <button onclick="addProduct()">增加商品</button>
    <button onclick="calculate()">计算</button>
    <div id="results"></div>

    <script>
        let productId = 0;

        function addProduct() {
            productId++;
            const productDiv = document.createElement('div');
            productDiv.classList.add('product-item');
            productDiv.id = `product-${productId}`;
            productDiv.innerHTML = `
                价格: <input type="number" id="price-${productId}" min="0" step="0.01"> 
                折扣: 
                <select id="discount-${productId}">
                    <option value="1">不打折</option>
                    <option value="0.9">九折</option>
                    <option value="0.8">八折</option>
                    <option value="0.7">七折</option>
                    <option value="0.6">六折</option>
                    <option value="0.55">五五折</option>
                </select>
                <button onclick="removeProduct(${productId})">删除</button>
            `;
            document.getElementById('products').appendChild(productDiv);
        }

        function removeProduct(id) {
            const productDiv = document.getElementById(`product-${id}`);
            document.getElementById('products').removeChild(productDiv);
        }

        function calculate() {
            const productDivs = document.getElementsByClassName('product-item');
            let originalTotal = 0;
            let discountedTotal = 0;

            for (let i = 0; i < productDivs.length; i++) {
                const id = productDivs[i].id.split('-')[1];
                const price = parseFloat(document.getElementById(`price-${id}`).value);
                const discount = parseFloat(document.getElementById(`discount-${id}`).value);

                if (!isNaN(price) && !isNaN(discount)) {
                    originalTotal += price;
                    discountedTotal += price * discount;
                }
            }

            const discountAmount = Math.floor(discountedTotal / 600) * 100;
            const finalTotal = discountedTotal - discountAmount;
            const nextDiscountThreshold = 600 - (discountedTotal % 600);

            document.getElementById('results').innerHTML = `
                商品原价: ${originalTotal.toFixed(2)}<br>
                折后价钱: ${discountedTotal.toFixed(2)}<br>
                满600减: ${discountAmount.toFixed(2)}<br>
                实际支付: ${finalTotal.toFixed(2)}<br>
                距离下一次满600减100还差: ${nextDiscountThreshold.toFixed(2)}元
            `;
        }
    </script>
</body>
</html>
